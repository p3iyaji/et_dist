import{C as h,r as i,u as C,b as c,D as y}from"./index-DN1la__8.js";const S=h("category",()=>{const o=i({}),p=i(null),n=i(!1),t=i({}),v=C();return{categories:o,currentCategory:p,isLoading:n,errorMessage:t,fetchCategories:async(r=1)=>{var a,s;v.isAuthenticated;try{n.value=!0;const e=await c.get(`/api/categories?page=${r}`);o.value=e.data}catch(e){t.value=((s=(a=e.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to fetch categories"}finally{n.value=!1}},createCategory:async r=>{var a,s,e;try{n.value=!0,t.value={};const l=await c.post("/api/categories",r);return o.value.push(l.data.category),l.data}catch(l){return l instanceof y&&((a=l.response)==null?void 0:a.status)===422?t.value=l.response.data.errors:t.value={general:[((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to create category"]},null}finally{n.value=!1}},updateCategory:async(r,a)=>{var s,e,l,d;try{n.value=!0,t.value={};const u=await c.put(`/api/categories/${r}`,a),g=(s=o.value.data)==null?void 0:s.findIndex(f=>f.id===r);return g!==-1&&o.value.data&&(o.value.data[g]=u.data.data),u.data}catch(u){return u instanceof y&&((e=u.response)==null?void 0:e.status)===422?t.value=u.response.data.errors:t.value={general:[((d=(l=u.response)==null?void 0:l.data)==null?void 0:d.message)||"Failed to update category"]},null}finally{n.value=!1}},fetchCategoryById:async r=>{try{return(await c.get(`/api/categories/${r}`)).data}catch{return t.value="Failed to fetch category",null}},deleteCategory:async r=>{var a,s;try{return n.value=!0,t.value=null,await c.delete(`/api/categories/${r}`),o.value.data=o.value.data.filter(e=>e.id!=r),o.value.total-=1,o.value.to-=1,!0}catch(e){throw t.value=((s=(a=e.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to delete category",e}finally{n.value=!1}}}});export{S as u};
