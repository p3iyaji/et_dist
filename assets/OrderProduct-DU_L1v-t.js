import{r as g,E as q,y as C,o as E,q as O,b as y,L as S,c as V,w as B,e as d,f as e,g as s,k,t as m,l as P,m as u,F as D,i as M,z as U,v as c,n as z}from"./index-C6ml-qKZ.js";import{_ as T}from"./AppLayout-CcZViM9-.js";import{S as i}from"./sweetalert2.esm.all-BQIkj5Wb.js";const N={class:"max-w-4xl mx-auto"},$={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden mb-6"},F={class:"p-6 border-b border-gray-200 dark:border-gray-700"},L={class:"flex justify-between items-center"},R={class:"text-gray-600 dark:text-gray-400 mt-1"},j={class:"font-semibold"},A={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-8 text-center"},H={key:1,class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden"},I={class:"p-6"},Q={class:"space-y-6"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg"},G=["value"],J=["value"],W=["value"],X={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Y=["value"],Z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ee={class:"flex justify-end pt-4"},re=["disabled"],te={key:0},oe={key:1,class:"flex items-center"},ue={__name:"OrderProduct",setup(ae){const f=C(),b=O(),t=g({product_id:"",product_name:"",supplier_id:"",quantity:1,unit_cost:0,total_cost:0,order_date:new Date().toISOString().split("T")[0],expected_delivery:"",notes:""}),v=g([]),p=g(!1),n=g(!1),l=q(()=>({id:f.query.product_id,name:f.query.product_name}));E(async()=>{if(!l.value.id){i.fire("Error","No product selected","error"),b.back();return}p.value=!0;try{const a=await y.get("/api/suppliers");v.value=a.data.data||a.data;try{const r=await y.get(`/api/products/${l.value.id}`),o=r.data.data||r.data;t.value.product_id=l.value.id,t.value.product_name=l.value.name,t.value.unit_cost=o.cost_price||0,x()}catch(r){console.error("Error fetching product details:",r),t.value.product_id=l.value.id,t.value.product_name=l.value.name}}catch(a){console.error("Error loading data:",a),i.fire("Error","Failed to load required data","error")}finally{p.value=!1}});const x=()=>{t.value.total_cost=t.value.quantity*t.value.unit_cost};S(()=>[t.value.quantity,t.value.unit_cost],()=>{x()});const w=async()=>{var a,r;if(!t.value.supplier_id){i.fire("Error","Please select a supplier","error");return}if(t.value.quantity<=0){i.fire("Error","Quantity must be greater than 0","error");return}n.value=!0;try{const o=await y.post("/api/purchase-orders",{product_id:t.value.product_id,supplier_id:t.value.supplier_id,quantity:t.value.quantity,unit_cost:t.value.unit_cost,total_cost:t.value.total_cost,order_date:t.value.order_date,expected_delivery:t.value.expected_delivery,notes:t.value.notes,status:"pending"});await i.fire({icon:"success",title:"Order Created!",text:`Order for ${t.value.quantity} units of ${t.value.product_name} has been placed successfully.`,confirmButtonText:"OK"}),b.push("/products")}catch(o){console.error("Error creating order:",o);const h=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to create order";i.fire("Error",h,"error")}finally{n.value=!1}},_=()=>{b.back()};return(a,r)=>(d(),V(T,null,{default:B(()=>[e("div",N,[e("div",$,[e("div",F,[e("div",L,[e("div",null,[r[7]||(r[7]=e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Place Product Order ",-1)),e("p",R,[r[6]||(r[6]=k(" Ordering: ")),e("span",j,m(l.value.name),1)])]),e("button",{onClick:_,type:"button",class:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Back ")])])]),p.value?(d(),s("div",A,r[8]||(r[8]=[e("div",{class:"flex justify-center items-center"},[e("svg",{class:"animate-spin h-8 w-8 text-teal-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("span",{class:"ml-3 text-lg"},"Loading order form...")],-1)]))):(d(),s("div",H,[e("div",I,[e("form",{onSubmit:P(w,["prevent"])},[e("div",Q,[e("div",K,[e("div",null,[r[9]||(r[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Product ID ",-1)),e("input",{value:t.value.product_id,type:"text",readonly:"",class:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-white cursor-not-allowed"},null,8,G)]),e("div",null,[r[10]||(r[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Product Name ",-1)),e("input",{value:t.value.product_name,type:"text",readonly:"",class:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-white cursor-not-allowed"},null,8,J)])]),e("div",null,[r[12]||(r[12]=e("label",{for:"supplier_id",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Supplier * ",-1)),u(e("select",{"onUpdate:modelValue":r[0]||(r[0]=o=>t.value.supplier_id=o),id:"supplier_id",required:"",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},[r[11]||(r[11]=e("option",{value:""},"Select a supplier",-1)),(d(!0),s(D,null,M(v.value,o=>(d(),s("option",{key:o.id,value:o.id},m(o.name)+" "+m(o.contact_person?`- ${o.contact_person}`:""),9,W))),128))],512),[[U,t.value.supplier_id]])]),e("div",X,[e("div",null,[r[13]||(r[13]=e("label",{for:"quantity",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Quantity * ",-1)),u(e("input",{"onUpdate:modelValue":r[1]||(r[1]=o=>t.value.quantity=o),type:"number",id:"quantity",min:"1",required:"",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[c,t.value.quantity,void 0,{number:!0}]])]),e("div",null,[r[14]||(r[14]=e("label",{for:"unit_cost",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Unit Cost (₦) ",-1)),u(e("input",{"onUpdate:modelValue":r[2]||(r[2]=o=>t.value.unit_cost=o),type:"number",id:"unit_cost",step:"0.01",min:"0",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[c,t.value.unit_cost,void 0,{number:!0}]])]),e("div",null,[r[15]||(r[15]=e("label",{for:"total_cost",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Total Cost (₦) ",-1)),e("input",{value:t.value.total_cost,type:"text",id:"total_cost",readonly:"",class:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-white cursor-not-allowed"},null,8,Y)])]),e("div",Z,[e("div",null,[r[16]||(r[16]=e("label",{for:"order_date",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Order Date ",-1)),u(e("input",{"onUpdate:modelValue":r[3]||(r[3]=o=>t.value.order_date=o),type:"date",id:"order_date",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[c,t.value.order_date]])]),e("div",null,[r[17]||(r[17]=e("label",{for:"expected_delivery",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Expected Delivery ",-1)),u(e("input",{"onUpdate:modelValue":r[4]||(r[4]=o=>t.value.expected_delivery=o),type:"date",id:"expected_delivery",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[c,t.value.expected_delivery]])])]),e("div",null,[r[18]||(r[18]=e("label",{for:"notes",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Notes ",-1)),u(e("textarea",{"onUpdate:modelValue":r[5]||(r[5]=o=>t.value.notes=o),id:"notes",rows:"3",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Any additional notes for this order..."},null,512),[[c,t.value.notes]])]),e("div",ee,[e("button",{type:"submit",disabled:n.value,class:z(["px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors duration-200",{"opacity-50 cursor-not-allowed":n.value}])},[n.value?(d(),s("span",oe,r[19]||(r[19]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),k(" Placing Order... ")]))):(d(),s("span",te,"Place Order"))],10,re)])])],32)])]))])]),_:1}))}};export{ue as default};
