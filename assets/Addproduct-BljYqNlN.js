import{o as L,E as x,r as p,c as q,w as I,q as N,e as d,f as e,g as i,h as n,j as l,t as c,l as G,m as u,v as g,x as v,G as R,k as h,A as D,n as O,H as T}from"./index-BLk6GGVK.js";import{_ as z}from"./AppLayout-CHbZXINC.js";import{s as w}from"./multiselect-Dd_lYqjo.js";import{u as F}from"./productStore-DqIC1bno.js";import{S as _}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{J as H}from"./JsBarcode-Bll_vn9Z.js";import{u as J}from"./unitStore-CtksribN.js";import{u as $}from"./categoryStore-D3v3dhrf.js";import"./_commonjsHelpers-Cpj98o6Y.js";const Q={class:"max-w-4xl mx-auto"},K={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden"},W={class:"p-6"},X={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Y={class:"space-y-6"},Z={key:0,class:"text-red-600"},ee={key:0,class:"text-red-600"},re={class:"flex gap-2"},te={key:0,class:"text-red-600"},ae={class:"mt-4"},oe={id:"barcode-svg",class:"w-full h-16"},se={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},le={key:0,class:"mb-4"},de={class:"relative inline-block"},ie=["src"],ne={class:"border-2 border-dashed border-gray-300 rounded-lg p-4"},ue={key:0,class:"mt-4"},ce={class:"relative inline-block"},ge=["src"],me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={key:0,class:"text-red-600"},be={key:0,class:"text-red-600"},ye={class:"flex items-center"},fe={class:"flex justify-end pt-4"},ke=["disabled"],xe={key:0},ve={key:1,class:"flex items-center"},Ae={__name:"Addproduct",setup(he){const b=J(),y=$(),s=F(),k=N();L(async()=>{try{await b.fetchUnits(),await y.fetchCategories()}catch(a){console.error("Error fetching data",a)}});const M=x(()=>Array.isArray(b.units.data)?b.units.data.map(a=>({id:a.id,name:a.name})):[]),C=x(()=>Array.isArray(y.categories.data)?y.categories.data.map(a=>({id:a.id,name:a.name})):[]),t=p({name:"",barcode:"",description:"",image:null,unit_id:null,category_id:null,price:null,cost_price:null,quantity:0,reorder_point:0,is_active:!0}),V=async()=>{try{let a="";for(let r=0;r<12;r++)a+=Math.floor(Math.random()*10);t.value.barcode=a,await T(),B()}catch(a){console.error("Error generating barcode:",a),t.value.barcode=Math.floor(1e12+Math.random()*9e12).toString()}},B=()=>{const a=document.getElementById("barcode-svg");if(!a){console.error("SVG element not found");return}try{a.innerHTML="",H(a,t.value.barcode,{format:"EAN13",lineColor:"#000",width:2,height:60,displayValue:!0,margin:10})}catch(r){console.error("Error rendering barcode:",r)}},P=p(null),m=p(null),f=p(null),S=a=>{const r=a.target.files[0];r&&(t.value.image=r,m.value={name:r.name,url:URL.createObjectURL(r)},a.target.value="")},U=()=>{m.value=null,t.image=null},A=()=>{f.value=null},E=async()=>{const a=new FormData;a.append("name",t.value.name),a.append("barcode",t.value.barcode),a.append("description",t.value.description),t.value.image&&a.append("image",t.value.image),a.append("unit_id",t.value.unit_id),a.append("category_id",t.value.category_id),a.append("price",t.value.price),a.append("cost_price",t.value.cost_price),a.append("quantity",t.value.quantity),a.append("reorder_point",t.value.reorder_point),a.append("is_active",t.value.is_active?1:0),(await s.createProduct(a)).success?(_.fire({toast:!0,icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3,title:"Product created successfully!"}),k.push("/products")):s.errorMessage.general&&_.fire({icon:"error",title:"Error",text:s.errorMessage.general[0]})},j=()=>{k.go(-1)};return(a,r)=>(d(),q(z,null,{default:I(()=>[e("div",Q,[e("div",K,[e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("div",{class:"flex justify-between items-center"},[r[10]||(r[10]=e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Add Product ",-1)),e("button",{onClick:j,type:"button",class:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Back ")])]),e("div",W,[l(s).errorMessage.general?(d(),i("div",X,c(l(s).errorMessage.general[0]),1)):n("",!0),e("form",{onSubmit:G(E,["prevent"])},[e("div",Y,[e("div",null,[r[11]||(r[11]=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Product Name ",-1)),u(e("input",{"onUpdate:modelValue":r[0]||(r[0]=o=>t.value.name=o),type:"text",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Enter product name"},null,512),[[g,t.value.name]]),l(s).errorMessage.name?(d(),i("span",Z,c(l(s).errorMessage.name[0]),1)):n("",!0)]),e("div",null,[r[12]||(r[12]=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Unit ",-1)),v(l(w),{modelValue:t.value.unit_id,"onUpdate:modelValue":r[1]||(r[1]=o=>t.value.unit_id=o),id:"unit_id",options:M.value,label:"name",valueProp:"id",searchable:!0,placeholder:"Select a unit",filterResults:!0,minChars:1,resolveOnLoad:!0,trackBy:"name"},null,8,["modelValue","options"]),l(s).errorMessage.unit_id?(d(),i("span",ee,c(l(s).errorMessage.unit_id[0]),1)):n("",!0)]),e("div",null,[r[13]||(r[13]=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Category ",-1)),v(l(w),{modelValue:t.value.category_id,"onUpdate:modelValue":r[2]||(r[2]=o=>t.value.category_id=o),id:"category_id",options:C.value,label:"name",valueProp:"id",searchable:!0,placeholder:"Select a category",filterResults:!0,minChars:1,resolveOnLoad:!0,trackBy:"name"},null,8,["modelValue","options"])]),e("div",null,[r[15]||(r[15]=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Barcode ",-1)),e("div",re,[u(e("input",{"onUpdate:modelValue":r[3]||(r[3]=o=>t.value.barcode=o),type:"text",id:"barcode",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Scan or enter barcode"},null,512),[[g,t.value.barcode]]),e("button",{onClick:V,type:"button",class:"px-6 py-2 mt-2 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors duration-200"}," Generate "),r[14]||(r[14]=e("br",null,null,-1)),l(s).errorMessage.barcode?(d(),i("span",te,c(l(s).errorMessage.barcode[0]),1)):n("",!0)]),e("div",ae,[u((d(),i("svg",oe,null,512)),[[R,t.value.barcode]]),t.value.barcode?(d(),i("p",se," Generated EAN-13: "+c(t.value.barcode),1)):n("",!0)])]),e("div",null,[r[17]||(r[17]=e("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Product Image ",-1)),f.value?(d(),i("div",le,[e("div",de,[e("img",{class:"w-24 h-24 rounded-sm object-cover",src:`/${f.value}`,alt:""},null,8,ie),e("span",{class:"absolute top-0 right-0 transform -translate-y-1/2 w-5 h-5 bg-red-400 border-2 border-white dark:border-gray-800 rounded-full cursor-pointer"},[e("span",{onClick:A,class:"text-white text-xs font-bold absolute flex items-center justify-center w-full h-full"},"×")])])])):n("",!0),e("div",ne,[e("input",{type:"file",id:"image",onChange:S,accept:"image/*",class:"hidden",ref_key:"fileInput",ref:P},null,544),r[16]||(r[16]=e("label",{for:"image",class:"flex flex-col items-center justify-center cursor-pointer"},[e("svg",{class:"w-8 h-8 mb-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})]),e("p",{class:"text-sm text-gray-500"},[e("span",{class:"font-semibold"},"Click to upload"),h(" or drag and drop ")]),e("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF up to 5MB")],-1)),m.value?(d(),i("div",ue,[e("div",ce,[e("img",{src:m.value.url,class:"w-24 h-24 object-cover rounded"},null,8,ge),e("button",{onClick:U,class:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center"}," × ")])])):n("",!0)])]),e("div",null,[r[18]||(r[18]=e("label",{for:"description",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Description ",-1)),u(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=o=>t.value.description=o),id:"description",rows:"6",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Enter product description"},null,512),[[g,t.value.description]])]),e("div",me,[e("div",null,[r[19]||(r[19]=e("label",{for:"cost_price",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Cost Price ",-1)),u(e("input",{"onUpdate:modelValue":r[5]||(r[5]=o=>t.value.cost_price=o),type:"number",id:"cost_price",min:"0",step:"0.01",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.cost_price]]),l(s).errorMessage.cost_price?(d(),i("span",pe,c(l(s).errorMessage.cost_price[0]),1)):n("",!0)]),e("div",null,[r[20]||(r[20]=e("label",{for:"price",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Selling Price ",-1)),u(e("input",{"onUpdate:modelValue":r[6]||(r[6]=o=>t.value.price=o),type:"number",id:"price",min:"0",step:"0.01",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.price]]),l(s).errorMessage.price?(d(),i("span",be,c(l(s).errorMessage.price[0]),1)):n("",!0)])]),e("div",null,[r[21]||(r[21]=e("label",{for:"quantity",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Quantity ",-1)),u(e("input",{"onUpdate:modelValue":r[7]||(r[7]=o=>t.value.quantity=o),type:"number",id:"quantity",min:"0",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.quantity]])]),e("div",null,[r[22]||(r[22]=e("label",{for:"reorder_point",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Reorder Point ",-1)),u(e("input",{"onUpdate:modelValue":r[8]||(r[8]=o=>t.value.reorder_point=o),type:"number",id:"reorder_point",min:"0",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.reorder_point]])]),e("div",ye,[u(e("input",{"onUpdate:modelValue":r[9]||(r[9]=o=>t.value.is_active=o),type:"checkbox",id:"is_active",class:"w-4 h-4 text-teal-600 bg-gray-100 border-gray-300 rounded focus:ring-teal-500 dark:focus:ring-teal-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[D,t.value.is_active]]),r[23]||(r[23]=e("label",{for:"is_active",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," Active ",-1))]),e("div",fe,[e("button",{type:"submit",disabled:l(s).isLoading,class:O(["px-6 py-3 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors duration-200",{"opacity-50 cursor-not-allowed":l(s).isLoading}])},[l(s).isLoading?(d(),i("span",ve,r[24]||(r[24]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),h(" Creating... ")]))):(d(),i("span",xe,"Create Product"))],10,ke)])])],32)])])])]),_:1}))}};export{Ae as default};
