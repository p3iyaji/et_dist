const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Calculator-BORaTsYy.js","assets/index-BddoOAJV.js","assets/index-CgRmoG83.css","assets/PaymentMethod-D81HqNyr.js","assets/sweetalert2.esm.all-BQIkj5Wb.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/PaymentMethod-C4LaYOxr.css","assets/ThermalInvoice-Buy23wZL.js"])))=>i.map(i=>d[i]);
import{r as i,D as P,o as Ye,g as n,f as t,h as f,c as xe,m,v as g,F as D,i as S,n as ne,y as U,t as d,s as We,j as z,H as re,z as Xe,I as et,b as k,p as tt,_ as ae,e as l,l as ue}from"./index-BddoOAJV.js";import{S as V}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";const st={class:"min-h-screen bg-gray-100"},lt={class:"container mx-auto px-4 py-8"},nt={class:"flex flex-col md:flex-row gap-4"},rt={class:"md:w-[60%] bg-white rounded-lg shadow p-4"},at={class:"flex justify-between items-center mb-4"},ut={class:"flex space-x-2"},it={class:"mb-4"},dt={class:"mb-6 relative"},ct=["onClick"],vt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3"},pt=["onClick"],mt={class:"h-16 bg-teal-100 flex items-center justify-center overflow-hidden transition-all duration-300 ease-in-out group-hover:h-24"},ft=["src","alt"],gt={key:1,class:"text-teal-400"},bt={class:"p-2 text-center"},xt={class:"product-name font-semibold text-teal-800 truncate"},yt={class:"product-price text-teal-800 font-semibold"},wt={key:0,class:"stock-warning text-red-500"},ht={class:"md:w-[40%] bg-white rounded-lg shadow p-4 sticky top-4 h-fit"},kt={class:"mb-4"},Ct=["value"],_t={key:0,class:"text-teal-500 text-center py-8"},Dt={key:1,class:"space-y-4"},St={class:"mb-4"},Mt=["value"],jt={class:"grid grid-cols-[1fr_auto]"},Vt={key:0,class:"text-red-600 text-sm mt-1"},qt={key:0,class:"mb-4"},Ot={class:"ml-1"},Pt={class:"flex items-center"},Et={class:"text-green-600 mr-2"},Bt=["onClick"],At={key:0,class:"flex justify-between items-center"},$t={class:"ml-1"},Tt={class:"flex items-center"},Rt={class:"text-green-600 mr-2"},Ut={class:"border-b border-teal-200 pb-2 mb-4"},Lt={class:"h-12 w-12 cart-item-image bg-teal-100 rounded-md overflow-hidden mr-3 flex-shrink-0"},It=["src","alt"],Nt={key:1,class:"text-teal-400 h-full flex items-center justify-center"},zt={class:"flex-1"},Ft={class:"tablet-text-sm font-medium text-teal-800"},Zt={class:"flex items-center justify-between mt-1"},Ht={class:"flex items-center"},Kt=["onClick"],Qt={class:"mx-2 w-6 text-center"},Gt=["onClick"],Jt=["onClick"],Yt={class:"font-medium text-teal-800"},Wt={class:"space-y-2 mb-6"},Xt={class:"flex justify-between"},eo={key:0,class:"flex justify-between text-green-600"},to={key:1,class:"flex justify-between text-green-600"},oo={class:"flex justify-between font-bold text-lg border-t border-gray-200 pt-2 mt-2"},so={class:"space-y-3"},lo={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},no={class:"bg-white rounded-lg p-6 w-full max-w-md"},ro={class:"space-y-4"},ao={class:"flex justify-end space-x-2 mt-4"},uo={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},io={class:"bg-white rounded-lg p-6 w-full max-w-md"},co={class:"space-y-4"},vo={key:0,class:"text-xs text-gray-500 mt-1"},po={key:0},mo=["value"],fo={class:"grid grid-cols-2 gap-4"},go={class:"flex items-center"},bo={class:"flex justify-end space-x-2 mt-4"},xo={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},yo={class:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto"},wo={class:"flex justify-between items-center mb-4"},ho={key:0,class:"text-center py-8 text-gray-500"},ko={key:1,class:"space-y-4"},Co={class:"flex justify-between items-start"},_o={class:"font-semibold"},Do={class:"text-sm text-gray-600"},So={class:"text-sm text-gray-600"},Mo={class:"text-sm text-gray-600"},jo={class:"flex space-x-2"},Vo=["onClick"],qo=["onClick"],Oo={key:6,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Po={class:"bg-white rounded-lg p-6 w-full max-w-md"},Eo={class:"flex justify-between items-center mb-4"},Bo={class:"space-y-4"},Ao=["value"],$o=["value"],To=["max"],Ro={class:"flex justify-end space-x-2 mt-6"},Uo={key:7,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Lo={class:"bg-white rounded-lg p-6 w-full max-w-2xl"},Io={class:"flex justify-between items-center mb-4"},No={class:"mb-4"},zo={class:"relative"},Fo={key:0,class:"text-center py-8 text-gray-500"},Zo={key:0},Ho={key:1},Ko={key:1,class:"max-h-[60vh] overflow-y-auto"},Qo=["onClick"],Go={class:"flex justify-between items-center"},Jo={class:"font-semibold"},Yo={class:"text-sm text-gray-600"},Wo={__name:"POS",setup(Xo){const ye=re(()=>ae(()=>import("./Calculator-BORaTsYy.js"),__vite__mapDeps([0,1,2]))),we=re(()=>ae(()=>import("./PaymentMethod-D81HqNyr.js"),__vite__mapDeps([3,1,2,4,5,6]))),he=re(()=>ae(()=>import("./ThermalInvoice-Buy23wZL.js"),__vite__mapDeps([7,1,2]))),Y=i([]),ie=i([]),c=i([]),E=i(""),q=i(null),M=i(""),L=i(null),x=i(null),W=i(null),y=i({}),w=i(null),de="https://api.realpayglobal.co.uk",ke=tt(),F=i(!1),ce=i(!1),Z=i(!1),X=i(null),Ce=i({name:"RPG-POS",address:"123 Business St, City",phone:"0800-123-4567",footer:"Thank you for your business!"}),H=i(!1),a=i({name:"",code:"",type:"percentage",value:0,scope:"product",product_id:null,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_active:!0}),C=i([]),K=i(!1),I=i(!1),B=i(null),A=i(0),Q=i(""),ee=i("cash"),te=i(!1),N=i(""),oe=i([]),_e=()=>{if(c.value.length===0){alert("Cannot save an empty cart as draft");return}const s={id:Date.now(),customer:j.value,items:c.value.map(e=>({product:e.product,quantity:e.quantity})),discounts:{productDiscounts:{...y.value},generalDiscount:w},subtotal:O.value,totalDiscount:Te.value,total:J.value,createdAt:new Date().toISOString()};C.value.push(s),localStorage.setItem("posDrafts",JSON.stringify(C.value)),V.fire({title:"Saved!",text:"Order saved as draft",icon:"success",confirmButtonText:"OK"}),le()},De=s=>{le(),j.value=s.customer,s.items.forEach(e=>{const r=Y.value.find(v=>v.id===e.product.id);r&&c.value.push({product:r,quantity:e.quantity,originalQuantity:r.quantity})}),y.value={...s.discounts.productDiscounts},w.value=s.discounts.generalDiscount,K.value=!1},Se=s=>{C.value=C.value.filter(e=>e.id!==s),localStorage.setItem("posDrafts",JSON.stringify(C.value))},Me=s=>{B.value=s,A.value=s.total_amount,I.value=!0},ve=async()=>{try{const s=await k.post("/api/pos-orders/search",{params:{query:N.value}});oe.value=s.data}catch(s){console.error("Error searching orders:",s),V.fire({title:"Error",text:"Failed to search orders",icon:"error"})}},je=async()=>{var s,e;try{(await k.post("/api/pos-orders/refund",{order_id:B.value.id,amount:A.value,reason:Q.value,payment_method:ee.value})).data.success&&(V.fire({title:"Refund Processed!",text:`Refund of ${b(A.value)} completed`,icon:"success",confirmButtonText:"OK"}),B.value=null,A.value=0,Q.value="",I.value=!1)}catch(r){console.error("Refund error:",r),V.fire({title:"Refund Failed",text:((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||"Error processing refund",icon:"error",confirmButtonText:"OK"})}},Ve=()=>{a.value.code||(a.value.code="DISC-"+Math.random().toString(36).substring(2,8).toUpperCase()),c.value.length>0&&(a.value.product_id=c.value[0].product.id),H.value=!0},qe=()=>{F.value=!F.value},Oe=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),ce.value=!1):(document.documentElement.requestFullscreen().catch(s=>{console.error(`Error attempting to enable full screen: ${s.message}`)}),ce.value=!0)},Pe=async()=>{var s,e;try{if(!a.value.name||!a.value.code||!a.value.value)throw new Error("Please fill all required fields");if(a.value.scope==="product"&&!a.value.product_id)throw new Error("Please select a product for product discount");const r={...a.value,value:parseFloat(a.value.value),product_ids:a.value.scope==="product"?[a.value.product_id]:[],apply_to_all_products:a.value.scope==="general"},v=await k.post("/api/pos-discounts",r);if(v.data.success){const u=v.data.discount;u.calculateDiscount=o=>u.type==="fixed"?Math.min(u.value,o):o*(u.value/100),u.scope==="product"?y.value[a.value.product_id]=u:w.value=u,a.value={name:"",code:"",type:"percentage",value:0,scope:"product",product_id:c.value.length>0?c.value[0].product.id:null,start_date:new Date().toISOString().split("T")[0],end_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],is_active:!0},H.value=!1,V.fire({title:"Success!",text:"Discount saved and applied successfully",icon:"success",confirmButtonText:"OK",confirmButtonColor:"#1e40af"})}}catch(r){console.error("Error applying new discount:",r),V.fire({title:"Error!",text:((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||r.message||"Error applying discount",icon:"error",confirmButtonText:"OK",confirmButtonColor:"#dc2626"})}},$=i([]),j=i(null),G=i(!1),h=i({name:"",phone:"",email:"",address:""}),se=async()=>{try{const s=await k.get("/api/customers");$.value=s.data.data;const e=$.value.find(r=>r.id===1);j.value=e||($.value.length>0?$.value[0]:null)}catch(s){console.error("Error fetching customers:",s)}},Ee=async()=>{try{const s=await k.post("/api/customers",h.value);$.value.push(s.data),j.value=s.data,G.value=!1,h.value={name:"",phone:"",email:"",address:""},await se()}catch(s){console.error("Error adding customer:",s)}},Be=()=>{G.value=!0},Ae=s=>{E.value=s},$e=P(()=>{let s=Y.value;if(E.value){const e=E.value.toLowerCase();s=s.filter(r=>{var v;return r.name.toLowerCase().includes(e)||((v=r.barcode)==null?void 0:v.toLowerCase().includes(e))})}return q.value&&(s=s.filter(e=>e.category_id===q.value)),s}),O=P(()=>c.value.reduce((s,e)=>s+e.product.price*e.quantity,0)),T=P(()=>c.value.reduce((s,e)=>{const r=y.value[e.product.id];return r?s+r.calculateDiscount(e.product.price*e.quantity):s},0)),R=P(()=>{if(!w.value)return 0;const s=O.value-T.value;return w.value.calculateDiscount(s)});P(()=>L.value?L.value.calculateDiscount(O.value):0);const Te=P(()=>T.value+R.value),J=P(()=>O.value-T.value-R.value),pe=async()=>{try{const s=await k.get("/api/pos-products");Y.value=s.data}catch(s){console.error("Error fetching products:",s)}},me=async()=>{try{const s=await k.get("/api/pos-categories");ie.value=s.data}catch(s){console.error("Error fetching categories:",s)}},Re=s=>{const e=c.value.find(r=>r.product.id===s.id);e?e.quantity<s.quantity?e.quantity++:alert(`Only ${s.quantity} available in stock`):s.quantity>0?c.value.push({product:s,quantity:1,originalQuantity:s.quantity}):alert("This product is out of stock")},Ue=s=>{const e=c.value[s];e.quantity<e.product.quantity?e.quantity++:alert(`Only ${e.product.quantity} available in stock`)},Le=s=>{const e=c.value[s];e.quantity>1?e.quantity--:fe(s)},fe=s=>{c.value.splice(s,1),c.value.length===0&&(L.value=null)},le=()=>{c.value=[],L.value=null,x.value=null},Ie=s=>{q.value=s},Ne=()=>{q.value=null},ze=async()=>{var s,e,r;if(x.value=null,L.value=null,!M.value){x.value="Please enter a discount code";return}try{let v=await k.get("/api/pos-discounts/validate",{params:{code:M.value,amount:O.value,quantity:c.value.reduce((u,o)=>u+o.quantity,0)}});if(v.data.valid){const u=v.data.discount;if(u.calculateDiscount=o=>u.type==="fixed"?Math.min(u.value,o):u.type==="percentage"?o*(u.value/100):0,v.data.scope==="product"){if(!((s=v.data.applicable_to)!=null&&s.product_id)){x.value="This discount requires selecting a specific product";return}y.value[v.data.applicable_to.product_id]=u}else w.value=u;M.value="",x.value=null}else{for(const u of c.value)if(v=await k.get("/api/pos-discounts/validate",{params:{code:M.value,product_id:u.product.id,amount:u.product.price*u.quantity,quantity:u.quantity}}),v.data.valid&&v.data.scope==="product"){const o=v.data.discount;o.calculateDiscount=p=>o.type==="fixed"?Math.min(o.value,p):o.type==="percentage"?p*(o.value/100):0,y.value[u.product.id]=o,M.value="",x.value=null;return}x.value=v.data.message||"Discount is not applicable to any products"}}catch(v){x.value=((r=(e=v.response)==null?void 0:e.data)==null?void 0:r.message)||"Error applying discount",console.error("Error applying discount:",v)}},Fe=s=>{const e=c.value.find(r=>r.product.id===s);return e?e.product.name:""},Ze=s=>{const e=c.value.find(r=>r.product.id===s);return e?e.product.price*e.quantity:0},He=s=>{delete y.value[s]},Ke=()=>{w.value=null},Qe=s=>{ge(s)},ge=async s=>{var e,r,v;if(c.value.length===0){alert("Your cart is empty");return}if(!j.value){alert("Please select a customer before completing the order");return}try{const u={customer_id:((e=j.value)==null?void 0:e.id)||1,payment_method:s.method,amount_tendered:s.amountTendered,change_due:s.changeDue,items:c.value.map(p=>{var _;return{product_id:p.product.id,quantity:p.quantity,price:p.product.price,discount_id:((_=y.value[p.product.id])==null?void 0:_.id)||null}}),subtotal:O.value,product_discounts:T.value||0,general_discount:R.value||0,total_amount:J.value};console.log(u);const o=await k.post("/api/pos-orders",u);o.data.success?(X.value=o.data.order,Z.value=!0,await V.fire({title:"Success!",text:"Order completed successfully!",icon:"success",confirmButtonText:"OK",confirmButtonColor:"#1e40af",timer:3e3,timerProgressBar:!0,didClose:()=>{Ge()}})):await V.fire({title:"Error!",text:o.data.message||"Error completing order",icon:"error",confirmButtonText:"Try Again",confirmButtonColor:"#dc2626"})}catch(u){console.error("Error completing order:",u),u.response&&(console.error("Response data:",u.response.data),console.error("Response status:",u.response.status)),alert(((v=(r=u.response)==null?void 0:r.data)==null?void 0:v.message)||"Error completing order. Please try again.")}},Ge=()=>{c.value=[],y.value={},w.value=null,M.value="",x.value=null,E.value="",q.value=null,pe(),me(),se()},b=s=>`₦${new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s)}`,be=s=>{W.value&&W.value.scrollBy({left:s*200,behavior:"smooth"})},Je=()=>{ke.push("/")};return Ye(()=>{const s=localStorage.getItem("posDrafts");s&&(C.value=JSON.parse(s)),pe(),me(),se()}),(s,e)=>{var r,v,u;return l(),n("div",st,[t("div",lt,[e[54]||(e[54]=t("h1",{class:"text-3xl text-teal-800 font-bold text-center mb-8"}," Point of Sale System ",-1)),t("div",nt,[t("div",rt,[t("div",at,[t("div",{class:"flex space-x-2"},[t("button",{onClick:qe,class:"p-2 bg-teal-800 text-white rounded-lg hover:bg-teal-700 transition"},e[34]||(e[34]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 15.75V18m-7.5-6.75h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25V13.5Zm0 2.25h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25V18Zm2.498-6.75h.007v.008h-.007v-.008Zm0 2.25h.007v.008h-.007V13.5Zm0 2.25h.007v.008h-.007v-.008Zm0 2.25h.007v.008h-.007V18Zm2.504-6.75h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V13.5Zm0 2.25h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V18Zm2.498-6.75h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V13.5ZM8.25 6h7.5v2.25h-7.5V6ZM12 2.25c-1.892 0-3.758.11-5.593.322C5.307 2.7 4.5 3.65 4.5 4.757V19.5a2.25 2.25 0 0 0 2.25 2.25h10.5a2.25 2.25 0 0 0 2.25-2.25V4.757c0-1.108-.806-2.057-1.907-2.185A48.507 48.507 0 0 0 12 2.25Z"})],-1)])),t("button",{onClick:Oe,class:"p-2 bg-teal-800 text-white rounded-lg hover:bg-teal-700 transition"},e[35]||(e[35]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)]))]),t("div",ut,[C.value.length!=0?(l(),n("button",{key:0,onClick:e[0]||(e[0]=o=>K.value=!0),class:"w-32 p-2 bg-blue-500 text-xs text-white py-3 rounded-lg font-bold hover:bg-black transition"}," Load Draft Orders ")):f("",!0),t("button",{onClick:e[1]||(e[1]=o=>te.value=!0),class:"w-32 bg-orange-600 text-xs text-white p-2 rounded-lg font-semibold hover:bg-red-700 transition"}," Process Refund "),t("button",{onClick:Je,type:"button",class:"p-2 bg-teal-800 text-white rounded-lg hover:bg-teal-700 transition"},e[36]||(e[36]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1)]))])]),t("div",it,[m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>E.value=o),type:"text",placeholder:"Search products...",class:"w-full p-3 border border-teal-300 rounded-md focus:outline-none focus:ring-2 focus:ring-teal-500"},null,512),[[g,E.value]])]),t("div",dt,[t("button",{class:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-white text-teal-800 border border-teal-800 rounded-full w-8 h-8 flex items-center justify-center shadow-md hover:bg-teal-600 transition",onClick:e[3]||(e[3]=o=>be(-1))}," ← "),t("button",{class:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-white text-teal-800 border border-teal-800 rounded-full w-8 h-8 flex items-center justify-center shadow-md hover:bg-teal-600 transition",onClick:e[4]||(e[4]=o=>be(1))}," → "),t("div",{ref_key:"categoriesContainer",ref:W,class:"flex rounded-md p-2 space-x-2 p-2 overflow-x-auto pb-2 mt-5 mb-5 border border-teal-800 shadow-lg scrollbar-hide"},[(l(!0),n(D,null,S(ie.value,o=>(l(),n("button",{key:o.id,onClick:p=>Ie(o.id),class:ne([{"bg-teal-800 text-white":q.value===o.id},"category-btn px-3 py-1 rounded-full text-white text-semibold bg-teal-700 hover:bg-teal-300 transition whitespace-nowrap"])},d(o.name),11,ct))),128)),t("button",{onClick:Ne,class:ne([{"bg-teal-800 text-white":q.value===null},"px-4 py-2 rounded-full text-white text-sm text-semibold bg-teal-700 hover:bg-teal-300 transition whitespace-nowrap"])}," All ",2)],512)]),t("div",vt,[(l(!0),n(D,null,S($e.value,o=>(l(),n("div",{key:o.id,onClick:p=>Re(o),class:"bg-white border border-teal-200 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition cursor-pointer group"},[t("div",mt,[o.image?(l(),n("img",{key:0,src:o.image?`${z(de)}/storage/${o.image}`:"/images/default-food.png",alt:o.name,class:"object-cover h-full w-full transition-all duration-300 ease-in-out group-hover:scale-105"},null,8,ft)):(l(),n("div",gt,e[37]||(e[37]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),t("div",bt,[t("h3",xt,d(o.name),1),t("p",yt,d(b(o.price)),1),o.quantity<=5?(l(),n("p",wt," Only "+d(o.quantity)+" left ",1)):f("",!0)])],8,pt))),128))])]),t("div",ht,[t("div",kt,[t("div",{class:"flex justify-between items-center mb-2"},[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-teal-700"},"Customer",-1)),t("button",{onClick:Be,class:"text-sm text-teal-600 hover:text-teal-800"}," + Add New Customer ")]),m(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>j.value=o),class:"w-full p-2 border border-teal-300 rounded-lg"},[(l(!0),n(D,null,S($.value,o=>(l(),n("option",{key:o.id,value:o},d(o.name)+" ("+d(o.phone)+") ",9,Ct))),128))],512),[[U,j.value]])]),e[53]||(e[53]=t("h2",{class:"text-xl font-bold mb-4"},"Current Order",-1)),c.value.length===0?(l(),n("div",_t,e[39]||(e[39]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})],-1),t("p",null,"Your cart is empty",-1),t("p",{class:"text-sm"},"Select products to add to your order",-1)]))):(l(),n("div",Dt,[t("div",St,[t("div",{class:"flex justify-between items-center mb-2"},[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-teal-700"},"Discount",-1)),t("button",{onClick:Ve,class:"text-sm text-teal-600 hover:text-teal-800"}," + Add New Discount ")]),m(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.selectedProductForDiscount=o),class:"w-full mb-2 p-2 border border-teal-300 rounded-lg"},[e[41]||(e[41]=t("option",{value:null},"Apply to entire order",-1)),(l(!0),n(D,null,S(c.value,o=>(l(),n("option",{key:o.product.id,value:o.product.id}," Apply to "+d(o.product.name)+" only ",9,Mt))),128))],512),[[U,s.selectedProductForDiscount]]),t("div",jt,[m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>M.value=o),type:"text",placeholder:"Enter discount code",class:"w-full p-2 border border-teal-300 rounded-l-lg focus:outline-none focus:ring-1 focus:ring-teal-500"},null,512),[[g,M.value]]),t("button",{onClick:ze,class:"bg-teal-800 text-white px-4 py-2 rounded-r-lg hover:bg-teal-700 transition"}," Apply ")]),x.value?(l(),n("p",Vt,d(x.value),1)):f("",!0)]),Object.keys(y.value).length>0||w.value?(l(),n("div",qt,[e[46]||(e[46]=t("h3",{class:"text-sm font-medium text-teal-700 mb-2"},"Applied Discounts",-1)),(l(!0),n(D,null,S(y.value,(o,p)=>(l(),n("div",{key:p,class:"flex justify-between items-center mb-1"},[t("div",null,[e[42]||(e[42]=t("span",{class:"text-green-600"},"Product Discount:",-1)),t("span",Ot,d(Fe(p))+" - "+d(o.name),1)]),t("div",Pt,[t("span",Et,"-"+d(b(o.calculateDiscount(Ze(p)))),1),t("button",{onClick:_=>He(p),class:"text-red-500 hover:text-red-700"},e[43]||(e[43]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Bt)])]))),128)),w.value?(l(),n("div",At,[t("div",null,[e[44]||(e[44]=t("span",{class:"text-green-600"},"Order Discount:",-1)),t("span",$t,d(w.value.name),1)]),t("div",Tt,[t("span",Rt,"-"+d(b(R.value)),1),t("button",{onClick:Ke,class:"text-red-500 hover:text-red-700"},e[45]||(e[45]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):f("",!0)])):f("",!0),t("div",Ut,[(l(!0),n(D,null,S(c.value,(o,p)=>(l(),n("div",{key:p,class:"cart-item flex items-center py-2 border-b border-teal-100"},[t("div",Lt,[o.product.image?(l(),n("img",{key:0,src:`${z(de)}/storage/${o.product.image}`,alt:o.product.name,class:"object-cover h-full w-full"},null,8,It)):(l(),n("div",Nt,e[47]||(e[47]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),t("div",zt,[t("h3",Ft,d(o.product.name),1),t("div",Zt,[t("div",Ht,[t("button",{onClick:ue(_=>Le(p),["stop"]),class:"w-6 h-6 flex items-center justify-center bg-teal-200 rounded hover:bg-teal-300"}," - ",8,Kt),t("span",Qt,d(o.quantity),1),t("button",{onClick:ue(_=>Ue(p),["stop"]),class:"w-6 h-6 flex items-center justify-center bg-teal-200 rounded hover:bg-teal-300"}," + ",8,Gt),t("button",{onClick:ue(_=>fe(p),["stop"]),class:"ml-2 text-red-500 hover:text-red-700"},e[48]||(e[48]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Jt)]),t("span",Yt,d(b(o.product.price*o.quantity)),1)])])]))),128)),t("div",Wt,[t("div",Xt,[e[49]||(e[49]=t("span",null,"Subtotal:",-1)),t("span",null,d(b(O.value)),1)]),T.value>0?(l(),n("div",eo,[e[50]||(e[50]=t("span",null,"Product Discounts:",-1)),t("span",null,"-"+d(b(T.value)),1)])):f("",!0),R.value>0?(l(),n("div",to,[e[51]||(e[51]=t("span",null,"Order Discount:",-1)),t("span",null,"-"+d(b(R.value)),1)])):f("",!0),t("div",oo,[e[52]||(e[52]=t("span",null,"Total:",-1)),t("span",null,d(b(J.value)),1)])]),t("div",so,[We(z(we),{"total-amount":J.value,onPaymentCompleted:Qe},null,8,["total-amount"]),t("button",{onClick:ge,class:"w-full tablet-btn bg-teal-800 text-white py-3 rounded-lg font-bold hover:bg-teal-700 transition"}," Complete Order "),t("button",{onClick:_e,class:"w-full bg-yellow-500 text-white py-3 rounded-lg font-bold hover:bg-yellow-600 transition"}," Save as Draft "),t("button",{onClick:le,class:"w-full bg-gray-200 text-gray-800 py-3 rounded-lg font-bold hover:bg-gray-300 transition"}," Clear Cart ")])])]))])])]),G.value?(l(),n("div",lo,[t("div",no,[e[59]||(e[59]=t("h3",{class:"text-lg font-bold mb-4 text-teal-600"},"Add New Customer",-1)),t("div",ro,[t("div",null,[e[55]||(e[55]=t("label",{class:"block text-sm font-medium text-gray-700"},"Name",-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>h.value.name=o),type:"text",class:"w-full p-2 border rounded"},null,512),[[g,h.value.name]])]),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium text-gray-700"},"Phone",-1)),m(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>h.value.phone=o),type:"text",class:"w-full p-2 border rounded"},null,512),[[g,h.value.phone]])]),t("div",null,[e[57]||(e[57]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),m(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>h.value.email=o),type:"email",class:"w-full p-2 border rounded"},null,512),[[g,h.value.email]])]),t("div",null,[e[58]||(e[58]=t("label",{class:"block text-sm font-medium text-gray-700"},"Address",-1)),m(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=o=>h.value.address=o),class:"w-full p-2 border rounded"},null,512),[[g,h.value.address]])])]),t("div",ao,[t("button",{onClick:e[12]||(e[12]=o=>G.value=!1),class:"px-4 py-2 bg-gray-200 rounded-lg"}," Cancel "),t("button",{onClick:Ee,class:"px-4 py-2 bg-teal-800 text-white rounded-lg"}," Save Customer ")])])])):f("",!0),F.value?(l(),xe(z(ye),{key:1,onClose:e[13]||(e[13]=o=>F.value=!1),onApply:Ae})):f("",!0),H.value?(l(),n("div",uo,[t("div",io,[e[71]||(e[71]=t("h3",{class:"text-lg font-bold mb-4 text-teal-600"},"Add New Discount",-1)),t("div",co,[t("div",null,[e[60]||(e[60]=t("label",{class:"block text-sm font-medium text-gray-500"},"Discount Name*",-1)),m(t("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>a.value.name=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[g,a.value.name]])]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-500"},"Discount Code*",-1)),m(t("input",{"onUpdate:modelValue":e[15]||(e[15]=o=>a.value.code=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[g,a.value.code]])]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-500"},"Discount Type*",-1)),m(t("select",{"onUpdate:modelValue":e[16]||(e[16]=o=>a.value.type=o),class:"w-full p-2 border rounded"},e[62]||(e[62]=[t("option",{value:"percentage"},"Percentage",-1),t("option",{value:"fixed"},"Fixed Amount",-1)]),512),[[U,a.value.type]])]),t("div",null,[e[64]||(e[64]=t("label",{class:"block text-sm font-medium text-gray-500"},"Value*",-1)),m(t("input",{"onUpdate:modelValue":e[17]||(e[17]=o=>a.value.value=o),type:"number",class:"w-full p-2 border rounded",required:""},null,512),[[g,a.value.value]]),a.value.type==="percentage"?(l(),n("p",vo,"Enter percentage (e.g., 10 for 10%)")):f("",!0)]),t("div",null,[e[66]||(e[66]=t("label",{class:"block text-sm font-medium text-gray-500"},"Scope*",-1)),m(t("select",{"onUpdate:modelValue":e[18]||(e[18]=o=>a.value.scope=o),class:"w-full p-2 border rounded"},e[65]||(e[65]=[t("option",{value:"product"},"Specific Product",-1),t("option",{value:"general"},"Entire Order",-1)]),512),[[U,a.value.scope]])]),a.value.scope==="product"?(l(),n("div",po,[e[67]||(e[67]=t("label",{class:"block text-sm font-medium text-gray-500"},"Apply to Product*",-1)),m(t("select",{"onUpdate:modelValue":e[19]||(e[19]=o=>a.value.product_id=o),class:"w-full p-2 border rounded",required:""},[(l(!0),n(D,null,S(c.value,o=>(l(),n("option",{value:o.product.id},d(o.product.name),9,mo))),256))],512),[[U,a.value.product_id]])])):f("",!0),t("div",fo,[t("div",null,[e[68]||(e[68]=t("label",{class:"block text-sm font-medium text-gray-500"},"Start Date",-1)),m(t("input",{"onUpdate:modelValue":e[20]||(e[20]=o=>a.value.start_date=o),type:"date",class:"w-full p-2 border rounded"},null,512),[[g,a.value.start_date]])]),t("div",null,[e[69]||(e[69]=t("label",{class:"block text-sm font-medium text-gray-500"},"End Date",-1)),m(t("input",{"onUpdate:modelValue":e[21]||(e[21]=o=>a.value.end_date=o),type:"date",class:"w-full p-2 border rounded"},null,512),[[g,a.value.end_date]])])]),t("div",null,[t("label",go,[m(t("input",{"onUpdate:modelValue":e[22]||(e[22]=o=>a.value.is_active=o),type:"checkbox",class:"rounded border-gray-300 text-teal-600 shadow-sm focus:border-teal-300 focus:ring focus:ring-teal-200 focus:ring-opacity-50"},null,512),[[Xe,a.value.is_active]]),e[70]||(e[70]=t("span",{class:"ml-2 text-sm text-gray-700"},"Active",-1))])])]),t("div",bo,[t("button",{onClick:e[23]||(e[23]=o=>H.value=!1),class:"px-4 py-2 bg-gray-200 rounded-lg"}," Cancel "),t("button",{onClick:Pe,class:"px-4 py-2 bg-teal-800 text-white rounded-lg"}," Save & Apply Discount ")])])])):f("",!0),Z.value&&X.value?(l(),xe(z(he),{key:3,order:X.value,"business-info":Ce.value,ref:"thermalInvoice",onClose:e[24]||(e[24]=o=>Z.value=!1)},null,8,["order","business-info"])):f("",!0),Z.value?(l(),n("button",{key:4,onClick:e[25]||(e[25]=o=>s.$refs.thermalInvoice.printInvoice()),class:"fixed bottom-4 right-4 bg-teal-800 text-white p-3 rounded-full shadow-lg z-50"},e[72]||(e[72]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1)]))):f("",!0),K.value?(l(),n("div",xo,[t("div",yo,[t("div",wo,[e[74]||(e[74]=t("h3",{class:"text-lg font-bold"},"Saved Draft Orders",-1)),t("button",{onClick:e[26]||(e[26]=o=>K.value=!1),class:"text-gray-500 hover:text-gray-700"},e[73]||(e[73]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),C.value.length===0?(l(),n("div",ho," No draft orders saved ")):(l(),n("div",ko,[(l(!0),n(D,null,S(C.value,o=>{var p;return l(),n("div",{key:o.id,class:"border rounded-lg p-4"},[t("div",Co,[t("div",null,[t("h4",_o,"Draft #"+d(o.id),1),t("p",Do," Customer: "+d(((p=o.customer)==null?void 0:p.name)||"No customer"),1),t("p",So,d(new Date(o.createdAt).toLocaleString()),1),t("p",Mo," Items: "+d(o.items.length)+" | Total: "+d(b(o.total)),1)]),t("div",jo,[t("button",{onClick:_=>De(o),class:"px-3 py-1 bg-teal-600 text-white rounded hover:bg-teal-700 text-sm"}," Load ",8,Vo),t("button",{onClick:_=>Se(o.id),class:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm"}," Delete ",8,qo)])])])}),128))]))])])):f("",!0),I.value?(l(),n("div",Oo,[t("div",Po,[t("div",Eo,[e[76]||(e[76]=t("h3",{class:"text-lg font-bold text-teal-600"},"Process Refund",-1)),t("button",{onClick:e[27]||(e[27]=o=>I.value=!1),class:"text-gray-500 hover:text-gray-700"},e[75]||(e[75]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",Bo,[t("div",null,[e[77]||(e[77]=t("label",{class:"block text-sm font-medium text-gray-500"},"Order #",-1)),t("input",{value:(r=B.value)==null?void 0:r.order_number,type:"text",class:"w-full p-2 border rounded",disabled:""},null,8,Ao)]),t("div",null,[e[78]||(e[78]=t("label",{class:"block text-sm font-medium text-gray-500"},"Original Amount",-1)),t("input",{value:b((v=B.value)==null?void 0:v.total),type:"text",class:"w-full p-2 border rounded",disabled:""},null,8,$o)]),t("div",null,[e[79]||(e[79]=t("label",{class:"block text-sm font-medium text-gray-500"},"Refund Amount*",-1)),m(t("input",{"onUpdate:modelValue":e[28]||(e[28]=o=>A.value=o),type:"number",max:(u=B.value)==null?void 0:u.total_amount,class:"w-full p-2 border rounded",required:""},null,8,To),[[g,A.value,void 0,{number:!0}]])]),t("div",null,[e[81]||(e[81]=t("label",{class:"block text-sm font-medium text-gray-500"},"Payment Method*",-1)),m(t("select",{"onUpdate:modelValue":e[29]||(e[29]=o=>ee.value=o),class:"w-full p-2 border rounded"},e[80]||(e[80]=[t("option",{value:"cash"},"Cash",-1),t("option",{value:"card"},"Card",-1),t("option",{value:"transfer"},"Bank Transfer",-1)]),512),[[U,ee.value]])]),t("div",null,[e[82]||(e[82]=t("label",{class:"block text-sm font-medium text-gray-500"},"Reason for Refund",-1)),m(t("textarea",{"onUpdate:modelValue":e[30]||(e[30]=o=>Q.value=o),class:"w-full p-2 border rounded",rows:"3"},null,512),[[g,Q.value]])])]),t("div",Ro,[t("button",{onClick:e[31]||(e[31]=o=>I.value=!1),class:"px-4 py-2 bg-gray-200 text-gray-500 rounded-lg hover:bg-gray-300"}," Cancel "),t("button",{onClick:je,class:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-red-700"}," Process Refund ")])])])):f("",!0),te.value?(l(),n("div",Uo,[t("div",Lo,[t("div",Io,[e[84]||(e[84]=t("h3",{class:"text-lg font-bold"},"Search Order to Refund",-1)),t("button",{onClick:e[32]||(e[32]=o=>te.value=!1),class:"text-gray-500 hover:text-gray-700"},e[83]||(e[83]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",No,[t("div",zo,[m(t("input",{"onUpdate:modelValue":e[33]||(e[33]=o=>N.value=o),onKeyup:et(ve,["enter"]),type:"text",placeholder:"Search by order number, customer name, or phone",class:"w-full p-3 border border-gray-300 rounded-lg pr-10"},null,544),[[g,N.value]]),t("button",{onClick:ve,class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-teal-800"},e[85]||(e[85]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)]))])]),oe.value.length===0?(l(),n("div",Fo,[N.value?(l(),n("p",Zo,'No orders found matching "'+d(N.value)+'"',1)):(l(),n("p",Ho,"Enter search terms to find orders"))])):(l(),n("div",Ko,[(l(!0),n(D,null,S(oe.value,o=>{var p;return l(),n("div",{key:o.id,class:"border-b border-gray-200 py-3 hover:bg-gray-50 cursor-pointer",onClick:_=>Me(o)},[t("div",Go,[t("div",null,[t("h4",Jo,"Order #"+d(o.order_no),1),t("p",Yo,d(((p=o.customer)==null?void 0:p.name)||"No customer")+" | "+d(b(o.total))+" | "+d(new Date(o.created_at).toLocaleString()),1)]),t("div",null,[t("span",{class:ne([{"bg-green-100 text-green-800":o.status==="completed","bg-red-100 text-red-800":o.status==="refunded","bg-yellow-100 text-yellow-800":o.status==="partially_refunded"},"text-xs px-2 py-1 rounded-full"])},d(o.status),3)])])],8,Qo)}),128))]))])])):f("",!0)])}}},ss=ot(Wo,[["__scopeId","data-v-d5751ee6"]]);export{ss as default};
