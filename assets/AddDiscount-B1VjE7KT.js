import{u as D,r as b,o as S,b as C,c as U,w as q,q as B,e as l,f as r,g as d,h as u,j as o,t as i,l as A,m as n,v as g,F as k,i as f,z as x,A as v,x as E,n as O,k as N}from"./index-BLk6GGVK.js";import{s as T}from"./multiselect-Dd_lYqjo.js";import{_ as j}from"./AppLayout-CHbZXINC.js";import{u as z}from"./discountStore-Bbd11FZT.js";import{S as _}from"./sweetalert2.esm.all-BQIkj5Wb.js";const F={class:"max-w-4xl mx-auto"},L={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden"},P={class:"p-6"},G={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},I={class:"space-y-6"},H={key:0,class:"text-red-600"},Q={key:0,class:"text-red-600"},R=["value"],X={key:0,class:"text-red-600"},Y={key:0,class:"text-red-600"},$={key:0,class:"text-red-600"},J={key:0,class:"text-red-600"},K={key:0,class:"text-red-600"},W={key:0,class:"text-red-600"},Z=["value"],ee={key:0,class:"text-red-600"},re={key:0,class:"space-y-4 p-4 border border-gray-200 rounded-lg"},te={class:"flex items-center"},ae={key:0,class:"space-y-2"},oe={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},se={key:1,class:"text-red-600 text-sm"},le={class:"flex items-center"},de={class:"flex justify-end pt-4"},ue=["disabled"],ie={key:0},ne={key:1,class:"flex items-center"},ke={__name:"AddDiscount",setup(ce){const p=D(),s=z(),m=B(),t=b({name:"",code:"",type:"percentage",value:null,start_date:null,end_date:null,min_quantity:null,min_amount:null,usage_limit:null,scope:"general",apply_to_all_products:!0,is_active:!0,product_ids:[]}),y=b([]),w=[{value:"percentage",label:"Percentage Discount"},{value:"fixed",label:"Fixed Amount Discount"},{value:"buy_x_get_y",label:"Buy X Get Y Offer"}],h=[{value:"general",label:"General"},{value:"product",label:"Product"}];S(async()=>{try{const c=await C.get("/api/products");y.value=c.data.data.map(e=>({value:e.id,label:e.name}))}catch(c){console.error("Error loading products:",c)}});const M=async()=>{var c;try{const{success:e,data:a}=await s.createDiscount({name:t.value.name,code:t.value.code,value:t.value.value,type:t.value.type,start_date:t.value.start_date?new Date(t.value.start_date).toISOString():null,end_date:t.value.end_date?new Date(t.value.end_date).toISOString():null,min_quantity:t.value.min_quantity,min_amount:t.value.min_amount,usage_limit:t.value.usage_limit,scope:t.value.scope,apply_to_all_products:t.value.scope==="product"?t.value.apply_to_all_products:null,is_active:t.value.is_active,product_ids:t.value.scope==="product"&&!t.value.apply_to_all_products?t.value.product_ids:[]});e&&(await _.fire({toast:!0,icon:"success",position:"top-end",showConfirmButton:!1,timer:3e3,title:a.message||"Discount created successfully!"}),m.push("/discounts"))}catch(e){console.error("Discount creation error:",e),await _.fire({icon:"error",title:"Error",text:((c=s.errorMessage.general)==null?void 0:c[0])||"Failed to create discount"})}},V=()=>{m.go(-1)};return(c,e)=>(l(),U(j,null,{default:q(()=>[r("div",F,[r("div",L,[r("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[r("div",{class:"flex justify-between items-center"},[e[12]||(e[12]=r("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Add Discounts ",-1)),r("button",{onClick:V,type:"button",class:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800"}," Back ")])]),r("div",P,[o(s).errorMessage.general?(l(),d("div",G,i(o(s).errorMessage.general[0]),1)):u("",!0),r("form",{onSubmit:A(M,["prevent"])},[r("div",I,[r("div",null,[e[13]||(e[13]=r("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Discount Name ",-1)),n(r("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.name=a),type:"text",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Enter discount name"},null,512),[[g,t.value.name]]),o(s).errorMessage.name?(l(),d("span",H,i(o(s).errorMessage.name[0]),1)):u("",!0)]),r("div",null,[e[14]||(e[14]=r("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Code ",-1)),n(r("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.code=a),type:"text",id:"code",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Enter discount code"},null,512),[[g,t.value.code]]),o(s).errorMessage.code?(l(),d("span",Q,i(o(s).errorMessage.code[0]),1)):u("",!0)]),r("div",null,[e[15]||(e[15]=r("label",{for:"name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Discount Type ",-1)),n(r("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.type=a),id:"type",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},[(l(),d(k,null,f(w,a=>r("option",{key:a.value,value:a.value},i(a.label),9,R)),64))],512),[[x,t.value.type]]),o(s).errorMessage.type?(l(),d("span",X,i(o(s).errorMessage.type[0]),1)):u("",!0)]),r("div",null,[e[16]||(e[16]=r("label",{for:"value",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Value ",-1)),n(r("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.value=a),type:"text",id:"value",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.value]]),o(s).errorMessage.value?(l(),d("span",Y,i(o(s).errorMessage.value[0]),1)):u("",!0)]),r("div",null,[e[17]||(e[17]=r("label",{for:"start_date",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Start Date ",-1)),n(r("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.start_date=a),type:"datetime-local",id:"start_date",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.start_date]]),o(s).errorMessage.start_date?(l(),d("span",$,i(o(s).errorMessage.start_date[0]),1)):u("",!0)]),r("div",null,[e[18]||(e[18]=r("label",{for:"end_date",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," End Date ",-1)),n(r("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.end_date=a),type:"datetime-local",id:"end_date",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.end_date]]),o(s).errorMessage.end_date?(l(),d("span",J,i(o(s).errorMessage.end_date[0]),1)):u("",!0)]),r("div",null,[e[19]||(e[19]=r("label",{for:"min_quantity",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Min Quantity ",-1)),n(r("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.min_quantity=a),type:"number",id:"min_quantity",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.min_quantity]]),o(s).errorMessage.min_quantity?(l(),d("span",K,i(o(s).errorMessage.min_quantity[0]),1)):u("",!0)]),r("div",null,[e[20]||(e[20]=r("label",{for:"min_amount",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Min Amount ",-1)),n(r("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.min_amount=a),type:"number",id:"min_amount",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[g,t.value.min_amount]]),o(s).errorMessage.min_amount?(l(),d("span",W,i(o(s).errorMessage.min_amount[0]),1)):u("",!0)]),r("div",null,[e[21]||(e[21]=r("label",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"}," Discount Scope ",-1)),n(r("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.scope=a),id:"scope",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},[(l(),d(k,null,f(h,a=>r("option",{key:a.value,value:a.value},i(a.label),9,Z)),64))],512),[[x,t.value.scope]]),o(s).errorMessage.scope?(l(),d("span",ee,i(o(s).errorMessage.scope[0]),1)):u("",!0)]),t.value.scope==="product"?(l(),d("div",re,[r("div",te,[n(r("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.apply_to_all_products=a),type:"checkbox",id:"apply_to_all_products",class:"w-4 h-4 text-teal-600 bg-gray-100 border-gray-300 rounded focus:ring-teal-500 dark:focus:ring-teal-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[v,t.value.apply_to_all_products]]),e[22]||(e[22]=r("label",{for:"apply_to_all_products",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," Apply to all products ",-1))]),t.value.apply_to_all_products?u("",!0):(l(),d("div",ae,[e[23]||(e[23]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white"}," Select Products ",-1)),E(o(T),{modelValue:t.value.product_ids,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.product_ids=a),options:y.value,mode:"tags",closeOnSelect:!1,searchable:!0,placeholder:"Select products",trackBy:"value",label:"label",object:!1,class:"multiselect"},null,8,["modelValue","options"]),t.value.product_ids&&t.value.product_ids.length>0?(l(),d("p",oe," Selected: "+i(t.value.product_ids.length)+" product(s) ",1)):u("",!0),o(s).errorMessage.product_ids?(l(),d("span",se,i(o(s).errorMessage.product_ids[0]),1)):u("",!0)]))])):u("",!0),r("div",le,[n(r("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.is_active=a),type:"checkbox",id:"is_active",class:"w-4 h-4 text-teal-600 bg-gray-100 border-gray-300 rounded focus:ring-teal-500 dark:focus:ring-teal-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[v,t.value.is_active]]),e[24]||(e[24]=r("label",{for:"is_active",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"}," Active ",-1))]),r("div",de,[r("button",{type:"submit",disabled:o(p).isLoading,class:O(["px-6 py-3 bg-teal-600 hover:bg-teal-700 text-white font-medium rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors duration-200",{"opacity-50 cursor-not-allowed":o(p).isLoading}])},[o(p).isLoading?(l(),d("span",ne,e[25]||(e[25]=[r("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),N(" Creating... ")]))):(l(),d("span",ie,"Create Discount"))],10,ue)])])],32)])])])]),_:1}))}};export{ke as default};
