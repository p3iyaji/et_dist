import{B as h,r as i,u as g,b as l,C as D}from"./index-BLk6GGVK.js";const A=h("discount",()=>{const r=i({}),v=i(null),n=i(!1),a=i({}),f=g();return{discounts:r,currentDiscount:v,isLoading:n,errorMessage:a,fetchDiscounts:async(u=1)=>{var s,e;f.isAuthenticated;try{n.value=!0;const t=await l.get(`/api/discounts?page=${u}`);r.value=t.data.data}catch(t){a.value=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to fetch discounts"}finally{n.value=!1}},createDiscount:async u=>{var s,e,t;try{n.value=!0,a.value={};const o=await l.post("/api/discounts",u);return a.value={},{success:!0,data:o.data}}catch(o){return((s=o.response)==null?void 0:s.status)===422?a.value=o.response.data.errors||{}:a.value={general:[((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||o.message||"Failed to create discount"]},{success:!1,error:a.value}}finally{n.value=!1}},updateDiscount:async(u,s)=>{var e,t,o,d;try{n.value=!0,a.value={};const c=await l.put(`/api/discounts/${u}`,s),p=(e=r.value.data)==null?void 0:e.findIndex(y=>y.id===u);return p!==-1&&r.value.data&&(r.value.data[p]=c.data.data),c.data}catch(c){return c instanceof D&&((t=c.response)==null?void 0:t.status)===422?a.value=c.response.data.errors:a.value={general:[((d=(o=c.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to update discount"]},null}finally{n.value=!1}},fetchDiscountById:async u=>{var s;try{const e=await l.get(`/api/discounts/${u}`);return{...e.data,product_ids:((s=e.data.products)==null?void 0:s.map(t=>t.id.toString()))||[]}}catch{return a.value="Failed to fetch discount",null}},deleteDiscount:async u=>{var s,e;try{return n.value=!0,a.value=null,await l.delete(`/api/discounts/${u}`),r.value.data=r.value.data.filter(t=>dicount.id!=u),r.value.total-=1,r.value.to-=1,!0}catch(t){throw a.value=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to delete discount",t}finally{n.value=!1}}}});export{A as u};
