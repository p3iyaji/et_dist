import{r as x,o as A,a as j,g as v,e as f,f as t,t as r,n as p,b as h,x as O,c as U,w as P,p as R,v as M,A as $,y as B,F as G,i as N}from"./index-DN1la__8.js";import{_ as C}from"./AppLayout-vBxF1_vo.js";import{c as _}from"./_commonjsHelpers-Cpj98o6Y.js";import"./settingsStore-B-d95HMW.js";var k={exports:{}},I=k.exports,T;function H(){return T||(T=1,function(w,y){(function(m,i){i()})(I,function(){function m(e,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function i(e,a,g){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){l(s.response,a,g)},s.onerror=function(){console.error("could not download file")},s.send()}function o(e){var a=new XMLHttpRequest;a.open("HEAD",e,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function u(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof _=="object"&&_.global===_?_:void 0,n=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!n?function(e,a,g){var s=d.URL||d.webkitURL,c=document.createElement("a");a=a||e.name||"download",c.download=a,c.rel="noopener",typeof e=="string"?(c.href=e,c.origin===location.origin?u(c):o(c.href)?i(e,a,g):u(c,c.target="_blank")):(c.href=s.createObjectURL(e),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){u(c)},0))}:"msSaveOrOpenBlob"in navigator?function(e,a,g){if(a=a||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(m(e,g),a);else if(o(e))i(e,a,g);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){u(s)})}}:function(e,a,g,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof e=="string")return i(e,a,g);var c=e.type==="application/octet-stream",L=/constructor/i.test(d.HTMLElement)||d.safari,F=/CriOS\/[\d]+/.test(navigator.userAgent);if((F||c&&L||n)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var b=S.result;b=F?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=b:location=b,s=null},S.readAsDataURL(e)}else{var E=d.URL||d.webkitURL,D=E.createObjectURL(e);s?s.location=D:location.href=D,s=null,setTimeout(function(){E.revokeObjectURL(D)},4e4)}});d.saveAs=l.saveAs=l,w.exports=l})}(k)),k.exports}H();const V={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},q={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-700"},W={class:"text-md font-bold text-gray-900 dark:text-white"},X={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-700"},z={class:"text-md font-bold text-gray-900 dark:text-white"},K={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-700"},Y={class:"text-md font-semibold text-gray-900 dark:text-white mb-1"},J={class:"text-md font-bold text-teal-600 dark:text-teal-400"},Q={__name:"ProfitLossChart",setup(w){const y=x(0),m=x(0),i=x({net_profit:0,net_margin:0}),o=x({}),u=x(null),d=l=>`₦${new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l)}`,n=async()=>{try{const l=await h.get("/api/orders/summary",{params:{start_date:new Date().toISOString().split("T")[0]}});y.value=l.data.total_sales;const e=new Date;e.setDate(1);const a=await h.get("/api/orders/summary",{params:{start_date:e.toISOString().split("T")[0]}});m.value=a.data.total_sales;const g=await h.get("/api/reports/profit-summary",{params:{start_date:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0]}});i.value=g.data;const s=await h.get("/api/products/top-selling");o.value=s.data.data}catch(l){console.error("Failed to fetch dashboard data:",l)}};return A(()=>{n(),u.value=setInterval(n,5*60*1e3)}),j(()=>{clearInterval(u.value)}),(l,e)=>(f(),v("div",V,[t("div",q,[e[0]||(e[0]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Today's Sales",-1)),t("div",W,r(d(y.value)),1)]),t("div",X,[e[1]||(e[1]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"This Month's Sales",-1)),t("div",z,r(d(m.value)),1)]),t("div",{class:p(["bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-700",{"bg-red-50 dark:bg-red-900/20":i.value.net_profit<0}])},[e[2]||(e[2]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Net Profit (30 Days)",-1)),t("div",{class:p(["text-md font-bold",i.value.net_profit<0?"text-red-600 dark:text-red-400":"text-gray-900 dark:text-white"])},r(d(i.value.net_profit)),3),t("div",{class:p(["text-sm mt-1",i.value.net_margin<0?"text-red-500 dark:text-red-300":"text-gray-500 dark:text-gray-400"])}," Margin: "+r(i.value.net_margin)+"% ",3)],2),t("div",K,[e[3]||(e[3]=t("h3",{class:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2"},"Top Selling Product",-1)),t("div",Y,r(o.value.name||"N/A"),1),t("div",J,r(d(o.value.revenue||0)),1)])]))}},Z={class:"bg-gray-50 dark:bg-gray-900 p-3 sm:p-5"},tt={class:"mx-auto max-w-screen-xl px-4 lg:px-12"},et={class:"bg-white dark:bg-gray-800 relative shadow-md sm:rounded-lg overflow-hidden"},at={class:"flex flex-col md:flex-row items-center justify-between space-y-3 md:space-y-0 md:space-x-4 p-4"},ot={class:"w-full md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4"},rt={class:"flex items-center space-x-2"},st={class:"flex items-center space-x-2"},nt={class:"flex items-center space-x-2"},dt={key:0,class:"p-8 text-center text-gray-500 dark:text-gray-400"},lt={key:1,class:"p-4 space-y-6"},it={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4"},ct={class:"p-4 bg-green-100 dark:bg-green-900 rounded-lg"},gt={class:"text-md font-bold text-green-800 dark:text-green-100"},ut={class:"p-4 bg-red-100 dark:bg-red-900 rounded-lg"},pt={class:"text-md font-bold text-red-800 dark:text-red-100"},xt={class:"p-4 bg-blue-100 dark:bg-blue-900 rounded-lg"},mt={class:"text-md font-bold text-blue-800 dark:text-blue-100"},yt={class:"text-sm text-blue-700 dark:text-blue-300"},ft={class:"p-4 bg-yellow-100 dark:bg-yellow-900 rounded-lg"},vt={class:"text-md font-bold text-yellow-800 dark:text-yellow-100"},bt={class:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow"},ht={class:"overflow-x-auto"},_t={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},kt={class:"px-4 py-3"},wt={class:"px-4 py-3 text-right"},St={class:"px-4 py-3 text-right"},Dt={class:"px-4 py-3 text-right"},Rt={class:"px-4 py-3 text-right"},Ft={class:"px-4 py-3 text-right"},Et={class:"bg-gray-50 dark:bg-gray-800 font-bold"},Mt={class:"px-4 py-3 text-right"},Tt={class:"px-4 py-3 text-right"},At={class:"px-4 py-3 text-right"},Lt={class:"px-4 py-3 text-right"},jt={class:"px-4 py-3 text-right"},Ot={key:2,class:"p-8 text-center text-gray-500 dark:text-gray-400"},Gt={__name:"ProfitAndLoss",setup(w){const y=x(new Date(new Date().setMonth(new Date().getMonth()-1)).toISOString().split("T")[0]),m=x(new Date().toISOString().split("T")[0]),i=x("month"),o=x(null),u=x(!1);A(()=>{O(),d()});const d=async()=>{u.value=!0;try{const l=await h.get("/api/reports/profit-and-loss",{params:{start_date:y.value,end_date:m.value,group_by:i.value}});o.value=l.data}catch(l){console.error("Failed to generate report:",l),alert("Failed to generate report. Please try again.")}finally{u.value=!1}},n=l=>`₦${new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l)}`;return(l,e)=>(f(),U(C,null,{default:P(()=>[t("section",Z,[t("div",tt,[t("div",et,[e[14]||(e[14]=t("h2",{class:"p-5 text-lg"},"Profit & Loss Report",-1)),t("div",at,[t("div",ot,[t("div",rt,[e[3]||(e[3]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"From:",-1)),R(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[M,y.value]])]),t("div",st,[e[4]||(e[4]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"To:",-1)),R(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>m.value=a),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},null,512),[[M,m.value]])]),t("div",nt,[e[6]||(e[6]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Group by:",-1)),R(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block p-2 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"},e[5]||(e[5]=[t("option",{value:"day"},"Daily",-1),t("option",{value:"week"},"Weekly",-1),t("option",{value:"month"},"Monthly",-1),t("option",{value:"year"},"Yearly",-1)]),512),[[$,i.value]])])]),t("div",{class:"flex space-x-3"},[t("button",{onClick:d,class:"flex items-center justify-center text-white bg-teal-700 hover:bg-teal-800 focus:ring-4 focus:ring-teal-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-teal-600 dark:hover:bg-teal-700 focus:outline-none dark:focus:ring-teal-800"}," Generate Report "),e[7]||(e[7]=t("button",{class:"flex items-center justify-center text-white bg-yellow-500 hover:bg-yellow-600 focus:ring-4 focus:ring-yellow-300 font-medium rounded-lg text-sm px-4 py-2 dark:bg-yellow-600 dark:hover:bg-yellow-700 focus:outline-none dark:focus:ring-yellow-800"}," Export to Excel ",-1))])]),u.value?(f(),v("div",dt," Loading report data... ")):o.value?(f(),v("div",lt,[t("div",it,[t("div",ct,[e[8]||(e[8]=t("h3",{class:"text-sm font-medium text-green-800 dark:text-green-200"},"Revenue",-1)),t("div",gt,r(n(o.value.totals.revenue)),1)]),t("div",ut,[e[9]||(e[9]=t("h3",{class:"text-sm font-medium text-red-800 dark:text-red-200"},"Cost of Goods",-1)),t("div",pt,r(n(o.value.totals.cogs)),1)]),t("div",xt,[e[10]||(e[10]=t("h3",{class:"text-sm font-medium text-blue-800 dark:text-blue-200"},"Gross Profit",-1)),t("div",mt,r(n(o.value.totals.gross_profit)),1),t("div",yt," Margin: "+r(o.value.totals.gross_margin)+"% ",1)]),t("div",ft,[e[11]||(e[11]=t("h3",{class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"},"Expenses",-1)),t("div",vt,r(n(o.value.totals.expenses)),1)]),t("div",{class:p(["p-4 rounded-lg",o.value.totals.net_profit<0?"bg-red-100 dark:bg-red-900":"bg-indigo-100 dark:bg-indigo-900"])},[t("h3",{class:p(["text-sm font-medium",o.value.totals.net_profit<0?"text-red-800 dark:text-red-200":"text-indigo-800 dark:text-indigo-200"])}," Net Profit ",2),t("div",{class:p(["text-md font-bold",o.value.totals.net_profit<0?"text-red-800 dark:text-red-100":"text-indigo-800 dark:text-indigo-100"])},r(n(o.value.totals.net_profit)),3),t("div",{class:p(["text-sm",o.value.totals.net_profit<0?"text-red-700 dark:text-red-300":"text-indigo-700 dark:text-indigo-300"])}," Margin: "+r(o.value.totals.net_margin)+"% ",3)],2)]),t("div",bt,[B(Q,{data:o.value.periods,"group-by":o.value.group_by},null,8,["data","group-by"])]),t("div",ht,[t("table",_t,[e[13]||(e[13]=t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[t("tr",null,[t("th",{scope:"col",class:"px-4 py-3"},"Period"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"Revenue"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"COGS"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"Gross Profit"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"Gross Margin"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"Expenses"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"Net Profit"),t("th",{scope:"col",class:"px-4 py-3 text-right"},"Net Margin")])],-1)),t("tbody",null,[(f(!0),v(G,null,N(o.value.periods,a=>(f(),v("tr",{key:a.period,class:"border-b dark:border-gray-700"},[t("td",kt,r(a.period),1),t("td",wt,r(n(a.revenue)),1),t("td",St,r(n(a.cogs)),1),t("td",Dt,r(n(a.gross_profit)),1),t("td",Rt,r(a.gross_margin)+"%",1),t("td",Ft,r(n(a.expenses)),1),t("td",{class:p(["px-4 py-3 text-right",{"text-red-600 dark:text-red-400":a.net_profit<0}])},r(n(a.net_profit)),3),t("td",{class:p(["px-4 py-3 text-right",{"text-red-600 dark:text-red-400":a.net_margin<0}])},r(a.net_margin)+"% ",3)]))),128)),t("tr",Et,[e[12]||(e[12]=t("td",{class:"px-4 py-3"},"Total",-1)),t("td",Mt,r(n(o.value.totals.revenue)),1),t("td",Tt,r(n(o.value.totals.cogs)),1),t("td",At,r(n(o.value.totals.gross_profit)),1),t("td",Lt,r(o.value.totals.gross_margin)+"%",1),t("td",jt,r(n(o.value.totals.expenses)),1),t("td",{class:p(["px-4 py-3 text-right",{"text-red-600 dark:text-red-400":o.value.totals.net_profit<0}])},r(n(o.value.totals.net_profit)),3),t("td",{class:p(["px-4 py-3 text-right",{"text-red-600 dark:text-red-400":o.value.totals.net_margin<0}])},r(o.value.totals.net_margin)+"% ",3)])])])])])):(f(),v("div",Ot," No report data available. Generate a report to view profit and loss information. "))])])])]),_:1}))}};export{Gt as default};
